function doPost(e) {
  // Ghi log dữ liệu nhận được
  Logger.log(JSON.stringify(e)); 
  
  // Kiểm tra xem e và e.parameter có tồn tại không
  if (!e || !e.parameter) {
    return ContentService.createTextOutput(JSON.stringify({ result: 'error', message: 'No data received' }))
                         .setMimeType(ContentService.MimeType.JSON);
  }

  const name = e.parameter.name || 'Unknown';
  const email = e.parameter.email || 'Unknown';
  const message = e.parameter.message || 'No message';

  const sheet = SpreadsheetApp.openById('YOUR_SPREADSHEET_ID').getActiveSheet();
  sheet.appendRow([name, email, message]);

  return ContentService.createTextOutput(JSON.stringify({ result: 'success' }))
                       .setMimeType(ContentService.MimeType.JSON);
}
